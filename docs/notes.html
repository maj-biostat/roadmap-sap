<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2027-02-05">

<title>Discussion points/notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="notes_files/libs/quarto-html/quarto.js"></script>
<script src="notes_files/libs/quarto-html/popper.min.js"></script>
<script src="notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="notes_files/libs/quarto-html/quarto-syntax-highlighting-fc6d358c97f25a8ea829b86655043430.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="notes_files/libs/bootstrap/bootstrap-59ca6f9bc2652f51a026b7e9873aa42c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-1.1---background" id="toc-section-1.1---background" class="nav-link active" data-scroll-target="#section-1.1---background">Section 1.1 - Background</a>
  <ul>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  </ul></li>
  <li><a href="#section-1.3---estimands" id="toc-section-1.3---estimands" class="nav-link" data-scroll-target="#section-1.3---estimands">Section 1.3 - Estimands</a></li>
  <li><a href="#additionalunnecessary-material" id="toc-additionalunnecessary-material" class="nav-link" data-scroll-target="#additionalunnecessary-material">Additional/unnecessary material</a>
  <ul>
  <li><a href="#discussion-1" id="toc-discussion-1" class="nav-link" data-scroll-target="#discussion-1">Discussion</a></li>
  <li><a href="#aside" id="toc-aside" class="nav-link" data-scroll-target="#aside">Aside</a></li>
  <li><a href="#discussion-2" id="toc-discussion-2" class="nav-link" data-scroll-target="#discussion-2">Discussion</a></li>
  </ul></li>
  <li><a href="#section-1.3.1.1---estimand-b.1-surgical-intervention" id="toc-section-1.3.1.1---estimand-b.1-surgical-intervention" class="nav-link" data-scroll-target="#section-1.3.1.1---estimand-b.1-surgical-intervention">Section 1.3.1.1 - Estimand B.1 (surgical intervention)</a>
  <ul>
  <li><a href="#update-required" id="toc-update-required" class="nav-link" data-scroll-target="#update-required">Update required</a></li>
  <li><a href="#discussion-3" id="toc-discussion-3" class="nav-link" data-scroll-target="#discussion-3">Discussion</a></li>
  <li><a href="#discussion-4" id="toc-discussion-4" class="nav-link" data-scroll-target="#discussion-4">Discussion!!!!</a></li>
  <li><a href="#discussion-required" id="toc-discussion-required" class="nav-link" data-scroll-target="#discussion-required">Discussion required</a></li>
  <li><a href="#discussionupdate-required" id="toc-discussionupdate-required" class="nav-link" data-scroll-target="#discussionupdate-required">Discussion/update required</a></li>
  <li><a href="#discussion-5" id="toc-discussion-5" class="nav-link" data-scroll-target="#discussion-5">Discussion</a></li>
  </ul></li>
  <li><a href="#section-1.3.1.2---estimand-d.1-antibiotic-duration-intervention" id="toc-section-1.3.1.2---estimand-d.1-antibiotic-duration-intervention" class="nav-link" data-scroll-target="#section-1.3.1.2---estimand-d.1-antibiotic-duration-intervention">Section 1.3.1.2 - Estimand D.1 (antibiotic duration intervention)</a>
  <ul>
  <li><a href="#discussion-6" id="toc-discussion-6" class="nav-link" data-scroll-target="#discussion-6">Discussion</a></li>
  </ul></li>
  <li><a href="#section-1.3.1.3---estimand-e.1-extended-prophylaxis-intervention" id="toc-section-1.3.1.3---estimand-e.1-extended-prophylaxis-intervention" class="nav-link" data-scroll-target="#section-1.3.1.3---estimand-e.1-extended-prophylaxis-intervention">Section 1.3.1.3 - Estimand E.1 (extended prophylaxis intervention)</a></li>
  <li><a href="#section-1.3.1.4---estimand-c.1-antibiotic-choice-intervention" id="toc-section-1.3.1.4---estimand-c.1-antibiotic-choice-intervention" class="nav-link" data-scroll-target="#section-1.3.1.4---estimand-c.1-antibiotic-choice-intervention">Section 1.3.1.4 - Estimand C.1 (antibiotic choice intervention)</a></li>
  <li><a href="#section-1.3.2.1---estimand-b.2-surgical-intervention" id="toc-section-1.3.2.1---estimand-b.2-surgical-intervention" class="nav-link" data-scroll-target="#section-1.3.2.1---estimand-b.2-surgical-intervention">Section 1.3.2.1 - Estimand B.2 (surgical intervention)</a></li>
  <li><a href="#section-1.4.3---data-management" id="toc-section-1.4.3---data-management" class="nav-link" data-scroll-target="#section-1.4.3---data-management">Section 1.4.3 - Data management</a></li>
  <li><a href="#section-2.1.2---per-protocol" id="toc-section-2.1.2---per-protocol" class="nav-link" data-scroll-target="#section-2.1.2---per-protocol">Section 2.1.2 - Per-protocol</a></li>
  <li><a href="#section-2.2---subgroups" id="toc-section-2.2---subgroups" class="nav-link" data-scroll-target="#section-2.2---subgroups">Section 2.2 - Subgroups</a></li>
  <li><a href="#section-2.3---descriptive-summaries" id="toc-section-2.3---descriptive-summaries" class="nav-link" data-scroll-target="#section-2.3---descriptive-summaries">Section 2.3 - Descriptive summaries</a></li>
  <li><a href="#section-2.4---sequential-analyses" id="toc-section-2.4---sequential-analyses" class="nav-link" data-scroll-target="#section-2.4---sequential-analyses">Section 2.4 - Sequential analyses</a></li>
  <li><a href="#section-2.6---primary-analysis" id="toc-section-2.6---primary-analysis" class="nav-link" data-scroll-target="#section-2.6---primary-analysis">Section 2.6 - Primary analysis</a></li>
  <li><a href="#section-2.6.1---priors" id="toc-section-2.6.1---priors" class="nav-link" data-scroll-target="#section-2.6.1---priors">Section 2.6.1 - Priors</a></li>
  <li><a href="#section-2.9---supportive-analyses" id="toc-section-2.9---supportive-analyses" class="nav-link" data-scroll-target="#section-2.9---supportive-analyses">Section 2.9 - Supportive analyses</a></li>
  <li><a href="#section-2.9.1---door" id="toc-section-2.9.1---door" class="nav-link" data-scroll-target="#section-2.9.1---door">Section 2.9.1 - DOOR</a></li>
  <li><a href="#section-2.9.11---time-alive-and-free-from-revision-procedure-to-24-months" id="toc-section-2.9.11---time-alive-and-free-from-revision-procedure-to-24-months" class="nav-link" data-scroll-target="#section-2.9.11---time-alive-and-free-from-revision-procedure-to-24-months">Section 2.9.11 - Time alive and free from revision procedure to 24 months</a></li>
  <li><a href="#section-2.10---supportive-domain-specific-analyses" id="toc-section-2.10---supportive-domain-specific-analyses" class="nav-link" data-scroll-target="#section-2.10---supportive-domain-specific-analyses">Section 2.10 - Supportive (domain specific) analyses</a></li>
  <li><a href="#section-2.10.1.1---treatment-success-at-12-months" id="toc-section-2.10.1.1---treatment-success-at-12-months" class="nav-link" data-scroll-target="#section-2.10.1.1---treatment-success-at-12-months">Section 2.10.1.1 - Treatment success at 12 months</a></li>
  <li><a href="#section-2.10.2.2---acute-liver-injury-following-platform-entry-to-90-days" id="toc-section-2.10.2.2---acute-liver-injury-following-platform-entry-to-90-days" class="nav-link" data-scroll-target="#section-2.10.2.2---acute-liver-injury-following-platform-entry-to-90-days">Section 2.10.2.2 - Acute liver injury following platform entry to 90 days</a></li>
  <li><a href="#section-2.10.2.3---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" id="toc-section-2.10.2.3---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="nav-link" data-scroll-target="#section-2.10.2.3---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days">Section 2.10.2.3 - Laboratory-proven Clostridium difficile diarrhoea to x days</a></li>
  <li><a href="#section-2.10.2.4---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" id="toc-section-2.10.2.4---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" class="nav-link" data-scroll-target="#section-2.10.2.4---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days">Section 2.10.2.4 - Antibiotics ceased due to suspected adverse reaction to 90 days</a></li>
  <li><a href="#section-2.10.3.2---time-alive-and-free-from-any-revision-procedure-to-12-months" id="toc-section-2.10.3.2---time-alive-and-free-from-any-revision-procedure-to-12-months" class="nav-link" data-scroll-target="#section-2.10.3.2---time-alive-and-free-from-any-revision-procedure-to-12-months">Section 2.10.3.2 - Time alive and free from any revision procedure to 12-months</a></li>
  <li><a href="#section-2.10.3.3---time-alive-and-free-from-any-revision-procedure-to-24-months" id="toc-section-2.10.3.3---time-alive-and-free-from-any-revision-procedure-to-24-months" class="nav-link" data-scroll-target="#section-2.10.3.3---time-alive-and-free-from-any-revision-procedure-to-24-months">Section 2.10.3.3 - Time alive and free from any revision procedure to 24-months</a></li>
  <li><a href="#section-2.10.3.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" id="toc-section-2.10.3.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="nav-link" data-scroll-target="#section-2.10.3.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days">Section 2.10.3.4 - Laboratory-proven <em>Clostridium difficile</em> diarrhoea to x days</a></li>
  <li><a href="#section-2.10.3.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" id="toc-section-2.10.3.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" class="nav-link" data-scroll-target="#section-2.10.3.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days">Section 2.10.3.5 - Antibiotics ceased due to suspected adverse reaction to 90 days</a></li>
  <li><a href="#section-2.10.4.2---acute-liver-injury-to-day-100" id="toc-section-2.10.4.2---acute-liver-injury-to-day-100" class="nav-link" data-scroll-target="#section-2.10.4.2---acute-liver-injury-to-day-100">Section 2.10.4.2 - Acute liver injury to day 100</a></li>
  <li><a href="#section-2.10.4.3---acute-liver-injurty-to-day-100" id="toc-section-2.10.4.3---acute-liver-injurty-to-day-100" class="nav-link" data-scroll-target="#section-2.10.4.3---acute-liver-injurty-to-day-100">Section 2.10.4.3 - Acute liver injurty to day 100</a></li>
  <li><a href="#section-2.10.4.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" id="toc-section-2.10.4.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="nav-link" data-scroll-target="#section-2.10.4.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days">Section 2.10.4.4 - Laboratory-proven <em>Clostridium difficile</em> diarrhoea to x days</a></li>
  <li><a href="#section-2.10.4.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-100-days" id="toc-section-2.10.4.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-100-days" class="nav-link" data-scroll-target="#section-2.10.4.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-100-days">Section 2.10.4.5 - Antibiotics ceased due to suspected adverse reaction to 100 days</a></li>
  <li><a href="#section-3.1---treatment-effects" id="toc-section-3.1---treatment-effects" class="nav-link" data-scroll-target="#section-3.1---treatment-effects">Section 3.1 - Treatment effects</a></li>
  <li><a href="#section-3.1.1---surgical-domain" id="toc-section-3.1.1---surgical-domain" class="nav-link" data-scroll-target="#section-3.1.1---surgical-domain">Section 3.1.1 - Surgical domain</a></li>
  <li><a href="#section-4.1---decision-procedures-overview" id="toc-section-4.1---decision-procedures-overview" class="nav-link" data-scroll-target="#section-4.1---decision-procedures-overview">Section 4.1 - Decision procedures overview</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Discussion points/notes</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 5, 2027</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 26, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="section-1.1---background" class="level1">
<h1>Section 1.1 - Background</h1>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>I previously included a statement on how we should interpret missing elements in the composite as a failure case (or alternative approach required) but I think I just wanted to know (1) how we should be handling this and (2) how likely it is to happen.</p>
<p>The core protocol, see section 6.6 Trial endpoints does not seem to indicate what happens when elements of the composite cannot be identified.</p>
</section>
</section>
<section id="section-1.3---estimands" class="level1">
<h1>Section 1.3 - Estimands</h1>
</section>
<section id="additionalunnecessary-material" class="level1">
<h1>Additional/unnecessary material</h1>
<p>Where the treatment policy strategy is used, any ICEs are effectively ignored and/or considered part of the treatment protocol. Where other methods of handling ICEs are used, it is important to recognise that treatment-specific ICEs may occur in isolation for a given unit or may occur in conjunction with ICEs applicable to treatments from other domains. For example, a patient may switch from DAIR to two-stage revision due to having a loose joint but also discontinue extended prophylaxis due to adverse reaction. In such cases, the ICEs are still handled by the applicable strategy for the estimand under consideration. For the above example, this implies that for the surgical domain comparison, we would likely consider the implication of the cross-over alone and not contemplate the impact that discontinuing may have. Similarly, when considering the extended prophylaxis comparison, we would likely only refer to the ICE associated with discontinuation and not the ICE relating to the loose joint. This pertspective aims to be simple, but it might do so at the cost of being naive.</p>
<section id="discussion-1" class="level2">
<h2 class="anchored" data-anchor-id="discussion-1">Discussion</h2>
<p>In the core protocol section 6.7.1 it has “To evaluate, within each relevant cell or combination of cells (as per the DSA), the effect of revealed randomised interventions compared to the domain control, on the probability of treatment success at 12 months after platform entry, in platform eligible participants”</p>
<p>What is meant by the reference to “within each relevant cell”?</p>
<p>In the Surgical late acute dsa section 9.1.1 “To evaluate, within the domain, the effect of revealed randomised intervention (revision) compared to the domain control (DAIR) on the probability of treatment success at 12 months after platform entry, in domain eligible participants.”</p>
<p>The above is silent on the status of the other variables that contribute to the probability of treatment success, I would interpret the underlying goal as one of trying to obtain a marginal effect (averaged over the sample).</p>
</section>
<section id="aside" class="level2">
<h2 class="anchored" data-anchor-id="aside">Aside</h2>
<p>Conditional OR: Among two hypothetical individuals with identical covariates <span class="math inline">\(X = x\)</span>, one given <span class="math inline">\(A=1\)</span> and one <span class="math inline">\(A=0\)</span>, the odds of death differ by a factor of <span class="math inline">\(\exp(\beta_A)\)</span>. Preference when making individual level inference or when covariates are effect modifiers.</p>
<p>Marginal OR: If the entire study population were switched from <span class="math inline">\(A=1\)</span> to <span class="math inline">\(A=0\)</span>, the overall odds of death would change by <span class="math inline">\(OR_{marg}\)</span>. More relevant to a policy context or when comparing to an unadjusted analysis.</p>
</section>
<section id="discussion-2" class="level2">
<h2 class="anchored" data-anchor-id="discussion-2">Discussion</h2>
<p>The estimands are introduced in generality in the core protocol and made specific in the DSA. I feel like the estimands are not currently providing much value because there isn’t enough detail and they do not really seem to consider the implications of ICEs on the existence or interpretation of the outcome. The purpose of an estimand specification is to ensure that the trial answers a very precise clinical question in a way that is clear and interpretable to all stakeholders (e.g., clinicians, regulators, patients), aligns with the trial objectives, and is both statistically valid and estimable from the collected data. If the estimands are inadequately specified, this could lead to criticism.</p>
<p>Given that the majority of the analyses follow a treatment-policy, I am bit torn as to whether the spending the time on clarifying things is going to make any real difference to anyone. One thing we could do to make things easier on us is to minimise duplicating the estimands across documents. For example, we might remove the estimands in the core protocol, which are not really adding anything, and just retain the DSA definitions. The rationale for this stems from the fact that the core protocol specifications do not relate to any single intervention and therefore do not really address the issues that estimands are intended to address, i.e.&nbsp;they do not provide clarity on what effects we are targeting nor on the ICEs as noted above. As a side note, in my opinion, I feel that if the overall objective is on assessing risk, then that should be what we are aiming to infer analytically rather than odds ratios and that is what is presently adopted in the sap.</p>
</section>
</section>
<section id="section-1.3.1.1---estimand-b.1-surgical-intervention" class="level1">
<h1>Section 1.3.1.1 - Estimand B.1 (surgical intervention)</h1>
<section id="update-required" class="level2">
<h2 class="anchored" data-anchor-id="update-required">Update required</h2>
<p>On (Page 19, ROADMAP Surgical Late Acute DSA. V1.1_01Aug2024.pdf) there is a note in parentheses that states “this will be estimated within hip versus knee strata”. If the intention is to have joint specific focus on the surgical treatment effects then this should be explicitly stated as part of the estimand objective.</p>
<p>At the stats meeting dated 9/12/2024, we decided to apply stopping rules to the aggregated hip and knee groups rather than adapting the trial based on joint specific effect. However, both overall and joint specific effects are to be reported (see later). This is not yet reflected in a released protocol.</p>
</section>
<section id="discussion-3" class="level2">
<h2 class="anchored" data-anchor-id="discussion-3">Discussion</h2>
<p>If a dair switches to one-stage (or two-stage) does this patient then enter into the respective duration domain?</p>
</section>
<section id="discussion-4" class="level2">
<h2 class="anchored" data-anchor-id="discussion-4">Discussion!!!!</h2>
<p>Currently, we obtain the effect of revision under the notion of apples versus apples. The only context in which this arises is when d2 and d3 are set to the non-randomised level.</p>
<p>An alternative practice is to contrast dair (plus d2 and d3 as given as usual practice under dair, which happens to be the non-randomised set to these domains) versus revision (plus d2 and d3 as given per the usual practice under revision and specifically the type of revision adopted). I think the latter is what is actually required (and makes most sense, at least to me at the moment).</p>
</section>
<section id="discussion-required" class="level2">
<h2 class="anchored" data-anchor-id="discussion-required">Discussion required</h2>
<p>Other ICEs are possibly relevant but not yet considered. Withdrawal based on clinician opinion on patient’s interests with regards to their involvement in roadmap. Even if a patient is withdrawn by request of the clinician, it may be acceptable to continue to collect data on such a patient, in which case the treatment policy would still be relevant.</p>
<p>Deviations from assigned treatment as variations in the accepted procedures (i.e.&nbsp;different from the protocol definitions) but not leading to switching also constitute an ICE that could impact the interpretation of the treatment effects. An example could be secondary surgery that does not lead to replacement of prosthetic, i.e.&nbsp;not handled via the composite strategy. Deviations from any protocol timings such as a requirement to have a surgical procedure within a given time window from randomisation. Also, it should be considered whether switchover should be interpreted as a failure rather than an ICE. Currently, any additional unspecified ICE would also be handled via the treatment policy strategy</p>
</section>
<section id="discussionupdate-required" class="level2">
<h2 class="anchored" data-anchor-id="discussionupdate-required">Discussion/update required</h2>
<p>I feel like risk differences are maybe preferable as they are more directly interpretable than odds ratios, albeit a bit more work to the analyst. However, the implication is that we need to be explicit about which population we are marginalising over but all that entails is saying that we are averaging over the sample. Typically, this would be the patients in the trial but given our comparisons are very specific, the levels which we use in the g-computation are also specific for some terms. The random effects will probably be taken to be zeros and so our inference will be interpretable for the ‘typical’ site (or whatever the random effect pertains to).</p>
</section>
<section id="discussion-5" class="level2">
<h2 class="anchored" data-anchor-id="discussion-5">Discussion</h2>
<p>I am wondering what the implications of switchover are on entry into the other domains. For example, a patient switches from DAIR to 2-stage revision. In theory, after the switch, they are eligible for entry into extended prophylaxis, but randomisation has already decided that they will receive non-randomised treatment for this domain.</p>
<p>Is this a problem? What should be done here?</p>
</section>
</section>
<section id="section-1.3.1.2---estimand-d.1-antibiotic-duration-intervention" class="level1">
<h1>Section 1.3.1.2 - Estimand D.1 (antibiotic duration intervention)</h1>
<section id="discussion-6" class="level2">
<h2 class="anchored" data-anchor-id="discussion-6">Discussion</h2>
<p>The DSA indicates “Participants will be randomised at platform entry in a fixed 1:1 ratio across the domain.” where “platform entry” is defined as “the timepoint when the patient has met core eligibility criteria, given informed consent for the platform, and been randomised” in the core protocol.</p>
<p>Get confirmation that <strong>receipt</strong> of one-stage revision is the correct population definition.</p>
<p>For all silos, the decision on the classification of surgery type appears to be made on completion of the surgery when the surgeon indicates that there are no plans for a second stage.</p>
<p>In the DSA for abx duration it states: “Platform eligible participants within any of the silos who have had a single stage revision will be randomised to receive either 6 weeks (short-course antibiotics) or 12 weeks (long-course antibiotics).”</p>
<p>Does that mean that someone who was in the late-acute silo and that was randomised to DAIR, but switched to one-stage revision due to a clinical decision (perhaps because of a loose joint) will then enter into the abx duration domain?</p>
<p>This setup suggests that allocations are generated across all domains for all patients irrespective of whether their dependencies negate the possibility of entry? For example, someone in late-acute is allocated to DAIR, but nevertheless they are also allocated to both the duration domains and the choice domain. I believe this is the case, but very much need to confirm.</p>
<p>So, patients can only be revealed to randomised assignment in the abx duration domain if they survive surgery. Implies start of follow up and treatment initiation not coincident, implies analysis is actually a landmark analysis and should be reflected as such for the relevant domains.</p>
<p><strong>If a patients dies during surgery, what is their treatment designation?</strong></p>
<p>If they do die (assuming we can obtain a treatment designation as one-stage), they are failure cases and would not be revealed to either of the abx duration. Isn’t this exactly the setup in which immortal time bias occurs?</p>
<p>We are not evaluating duration effects in the population, we are looking at duration effects based on a post-randomisation event, i.e.&nbsp;survival through surgery. We are selecting based on survival. Yes, but the analysis is landmarked and we still have a randomised comparison.</p>
</section>
</section>
<section id="section-1.3.1.3---estimand-e.1-extended-prophylaxis-intervention" class="level1">
<h1>Section 1.3.1.3 - Estimand E.1 (extended prophylaxis intervention)</h1>
<p>ICE and treatment regimen:</p>
<p>todo - Get more detail on E.1(i2) and check my interpretation is correct. Would the ineligibility actually mean that they do not receive the extended prophylaxis but would receive extended backbone antibiotic?</p>
</section>
<section id="section-1.3.1.4---estimand-c.1-antibiotic-choice-intervention" class="level1">
<h1>Section 1.3.1.4 - Estimand C.1 (antibiotic choice intervention)</h1>
<p>Clarify C.1(i1) - would this still constitute switchover after the delayed start (or rescue)?</p>
<p>As with other domains, patient discharge/relocation is probably relevant as another ICE.</p>
</section>
<section id="section-1.3.2.1---estimand-b.2-surgical-intervention" class="level1">
<h1>Section 1.3.2.1 - Estimand B.2 (surgical intervention)</h1>
<p>Should the secondary estimands be removed?</p>
<p>High level lay overview:</p>
<p>The manner in which the estimand is currently written, aligns with a per-protocol analysis whereby only those patients that were adherent to their assigned (observed) treatment are retained in the analysis. This doesn’t consider whether those patients would also be adherent in their counterfactual treatment. The problem with this is that it violates the randomisation - the groups might be unbalanced on either known or unknown (or both) confounders. The traditional per-protocol effect is well known to produce biased estimates for treatment effects. What I believe is of interest is the effect of the surgical intervention in those that would have adhered to all arms. Given that the ICEs for the surgical domain negate the possibility of forcing the assignment on the patient, principal strata seems like the most well aligned approach. But this is very hard to implement in our setting. Are there any other options?</p>
<p>ICEs and treatment regimen:</p>
<p>The DSA currently states that principle stratum strategy is to be used as the single mechanism for handling ICEs. Obviously, this is a placeholder as it was a fairly arbitrary inclusion. For the surgical domain currently specified ICEs are switchover to revision for DAIR where the joint is loose and similarly for revision when the it is not possible to remove the existing implant. Additionally, revision might be abandoned if the patient becomes unstable during the operation. To handle these via desired strategy we first conceptualise strata. The subset associated with the compliers (however that is defined here) would be the one for which we would estimate the effect of DAIR vs revision.</p>
</section>
<section id="section-1.4.3---data-management" class="level1">
<h1>Section 1.4.3 - Data management</h1>
<p>todo - double check and write up on how this functionality is being decomposed. What are the redcap parts and what belongs to spiral?</p>
</section>
<section id="section-2.1.2---per-protocol" class="level1">
<h1>Section 2.1.2 - Per-protocol</h1>
<p>Principal stratum is referred to as a per-protocol in the DSAs but this is incorrect.</p>
<p>Per-protocol analyses traditionally exclude those patients that deviate from the protocol and conduct the primary analysis with this subset. The results from such analyses will only be valid where deviations from the protocol are non-informative.</p>
<p>Consider (1) exclusions can imbalance treatment groups on known or unknown confounders and prognostic factors (2) that noncompliance may relate to a specific intervention or disease severity producing differential dropout across arms.</p>
<p>Specific questions on the protocol definitions:</p>
<ul>
<li>For the 6wk and 12wk antibiotic duration assignment, is there a reqt for no abx after 16 wks?</li>
<li>For the extended prophylaxis, is there a reqt for no abx after 90 days?</li>
<li>For the Rifampicin, is there any requirement for the interval between the doses?</li>
<li>Are we only considering per-protocol with respect to treatment?</li>
</ul>
</section>
<section id="section-2.2---subgroups" class="level1">
<h1>Section 2.2 - Subgroups</h1>
<p>Title should be updated to subgroup analyses, not secondary analyses for:</p>
<p>DSA Surgical Late-acute section 9.6 DSA for AB duration part A section 9.6 DSA AB Duration part B section 8.6 (toc does not link correctly) DSA AB Choice section 9.6 (this has both secondary and subgroup analyses, keeping a clear separation between the two would be helpful)</p>
<p>Clarify how duration of symptoms is intended to be categorised for surgical domain.</p>
<p>For surgical domain, categorise time from implantation or get rid of.</p>
<p>For backbone duration, discuss removing ideal procedure vs not as this suggests a protocol deviation.</p>
<p>For ext proph, categorise duration between first and second and duration of antibiotic treatment between first stage and reimplant.</p>
<p>For ab choice, include silo or was that purposefully excluded as rif is expected to work by the same action?</p>
<p>There was a review question at the top of the subgroup section for which clarification is needed - <em>is it obvious what this means (in the parameter estimation)?</em></p>
<p>For one-stage vs two-stage - this is a post-randomisation subgroup, so could be influenced by previously revealed assignments, eg rifampicin. AB Choice is revealed and administration commenced following the first procedure, i.e.&nbsp;after a DAIR, one-stage or between the first and second stage of a two-stage revision and therefore, the reveal of AB choice will not influence selection of surgery type.</p>
</section>
<section id="section-2.3---descriptive-summaries" class="level1">
<h1>Section 2.3 - Descriptive summaries</h1>
<p>Query how the consent process works for say AB choice where eligibility is not assessed until after the initial surgical treatment?</p>
</section>
<section id="section-2.4---sequential-analyses" class="level1">
<h1>Section 2.4 - Sequential analyses</h1>
<p>Revisit the timing of interim analyses as enrolment always seems to be a major challenge.</p>
<p>I think it is probably more operationally practical to run interims on a regular timing rather than for fixed sample size, but I still generally prefer the latter for simplicity of understanding in the design operating characterisitcs.</p>
<p>The subgroup analysis at each interim used to determine whether the trial should continue is problematic because</p>
<ol type="1">
<li>it opens us up to severe critiscm of un-specified decisions occurring</li>
<li>type i inflation</li>
</ol>
</section>
<section id="section-2.6---primary-analysis" class="level1">
<h1>Section 2.6 - Primary analysis</h1>
<p>Incorporate silos as random effect on d1 treatment deviations?</p>
<p>Revisit the baseline characteristics to be included in the model. Reference some of the subgroups for ideas.</p>
</section>
<section id="section-2.6.1---priors" class="level1">
<h1>Section 2.6.1 - Priors</h1>
<p>todo - revisit baseline covariates with clinical group.</p>
<p>Question - Would it be preferable/more sensible to model on a finer granularity, i.e.&nbsp;monthly, quarterly etc?</p>
</section>
<section id="section-2.9---supportive-analyses" class="level1">
<h1>Section 2.9 - Supportive analyses</h1>
<p>TODO - Query the competing risks, what is relevant/sensible to consider?</p>
<p>Should we revise the estimand definition such that we state clearly the issue of competing risk and that it is a part of the estimand that is being targeted (or change the estimand and estimation approach completely)?</p>
</section>
<section id="section-2.9.1---door" class="level1">
<h1>Section 2.9.1 - DOOR</h1>
<p>Care has to be taken when interpreting a PI. First, the measure is NOT the probability that a patient will benefit from having the experimental treatment rather than control, which can generally only be obtained from a cross-over trial. For example, a PI of 0.7 means that if you randomly select a patient from the experimental group and another from the control group, there is a 70% chance the experimental group patient will have a better outcome. This is not the same as saying that 70% of patients will benefit from the experimental treatment. For further cautions, limitations and critique on interpretation see <span class="citation" data-cites="Senn2011">@Senn2011</span>.</p>
<p>A Bayesian approach to the MWU does exist, but has not been widely adopted to date and so we have opted for the above approach. <span class="citation" data-cites="Chechile2020">@Chechile2020</span> provides details on the Bayesian perspective.</p>
</section>
<section id="section-2.9.11---time-alive-and-free-from-revision-procedure-to-24-months" class="level1">
<h1>Section 2.9.11 - Time alive and free from revision procedure to 24 months</h1>
<p>The M-spline should include an intercept so that <span class="math inline">\(h(t)\)</span> is not constrained to zero at the origin and the coefficients are constrained to a simplex for identifiability. todo - go back and review M-spline vs B-spline differences in approach, stability, fit for purpose and so on.</p>
<p>todo - This deviates from the current estimand specification A.12 (Pg 39 ROADMAP Core Protocol_V1.1_01Aug2024_clean.pdf) which, I believe, intends a descriptive summary.</p>
</section>
<section id="section-2.10---supportive-domain-specific-analyses" class="level1">
<h1>Section 2.10 - Supportive (domain specific) analyses</h1>
<p>todo - Get the DSA estimand specifications update to indicate that these are all up to 12 months.</p>
</section>
<section id="section-2.10.1.1---treatment-success-at-12-months" class="level1">
<h1>Section 2.10.1.1 - Treatment success at 12 months</h1>
<p>todo - finalise approach for this alternative to itt. This is within the domain-specific section as we take a domain specific approach for the ICEs. Ditto with the other domains. Discuss.</p>
</section>
<section id="section-2.10.2.2---acute-liver-injury-following-platform-entry-to-90-days" class="level1">
<h1>Section 2.10.2.2 - Acute liver injury following platform entry to 90 days</h1>
<p>todo - Check whether this was meant to be 90 days <strong>post commencement of antibiotics</strong> rather than post platform entry, the former requiring a different approach.</p>
</section>
<section id="section-2.10.2.3---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="level1">
<h1>Section 2.10.2.3 - Laboratory-proven Clostridium difficile diarrhoea to x days</h1>
<p>todo - Check whether this should have a time limit on it. Presumably also 90 days…</p>
</section>
<section id="section-2.10.2.4---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" class="level1">
<h1>Section 2.10.2.4 - Antibiotics ceased due to suspected adverse reaction to 90 days</h1>
<p>todo - What is meant by other?<br>
Check whether this was meant to be 90 days post commencement of antibiotics.</p>
</section>
<section id="section-2.10.3.2---time-alive-and-free-from-any-revision-procedure-to-12-months" class="level1">
<h1>Section 2.10.3.2 - Time alive and free from any revision procedure to 12-months</h1>
<p>todo - This seems like it would be domain agnostic. Not sure what it is doing in the DSA for ExP</p>
</section>
<section id="section-2.10.3.3---time-alive-and-free-from-any-revision-procedure-to-24-months" class="level1">
<h1>Section 2.10.3.3 - Time alive and free from any revision procedure to 24-months</h1>
<p>todo - Again, this seems like it would be domain agnostic. Not sure what it is doing in the DSA for ExP</p>
</section>
<section id="section-2.10.3.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="level1">
<h1>Section 2.10.3.4 - Laboratory-proven <em>Clostridium difficile</em> diarrhoea to x days</h1>
<p>todo - Check whether this should have a time limit on it. Presumably 90 days as per ab duration domain</p>
</section>
<section id="section-2.10.3.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-90-days" class="level1">
<h1>Section 2.10.3.5 - Antibiotics ceased due to suspected adverse reaction to 90 days</h1>
<p>todo - What is meant by other?<br>
Check whether this was meant to be 90 days post commencement of extended prophylaxis.</p>
</section>
<section id="section-2.10.4.2---acute-liver-injury-to-day-100" class="level1">
<h1>Section 2.10.4.2 - Acute liver injury to day 100</h1>
<p>todo - Check whether this should be <strong>post commencement of rif</strong>.</p>
</section>
<section id="section-2.10.4.3---acute-liver-injurty-to-day-100" class="level1">
<h1>Section 2.10.4.3 - Acute liver injurty to day 100</h1>
<p>todo - Check if c.4 is a duplicate??</p>
</section>
<section id="section-2.10.4.4---laboratory-proven-clostridium-difficile-diarrhoea-to-x-days" class="level1">
<h1>Section 2.10.4.4 - Laboratory-proven <em>Clostridium difficile</em> diarrhoea to x days</h1>
<p>todo - Check whether this should have a time limit on it. Presumably 90 days as per ab duration domain</p>
</section>
<section id="section-2.10.4.5---antibiotics-ceased-due-to-suspected-adverse-reaction-to-100-days" class="level1">
<h1>Section 2.10.4.5 - Antibiotics ceased due to suspected adverse reaction to 100 days</h1>
<p>todo - Check why this is 100 days and others are 90. Should these all be made the same?</p>
</section>
<section id="section-3.1---treatment-effects" class="level1">
<h1>Section 3.1 - Treatment effects</h1>
<p>Old notes - review and recast if necessary:</p>
<p>To expand on the above, assume that when a unit is randomised to revision and the clinical decision of what type of revision to do is based solely on disease severity with more severe units receiving one-stage and those that are less severe receive two-stage. This violates the exchangeability assumption in that if <span class="math inline">\(\mathbb{E}[Y|T = 1] = y_1\)</span> and <span class="math inline">\(\mathbb{E}[Y|T = 2] = y_2\)</span> (with <span class="math inline">\(Y\)</span> denoting the observed outcomes and <span class="math inline">\(T = 1\)</span>, <span class="math inline">\(T = 2\)</span> denoting receipt of one and two-stage) then we would not obtain the same expectations if the sets of treatment units were switched. In other words, <span class="math inline">\(\mathbb{E}[Y(1) | T = 1] \ne \mathbb{E}[Y(1) | T = 2] \ne \mathbb{E}[Y(1)]\)</span> and <span class="math inline">\(\mathbb{E}[Y(2) | T = 1] \ne \mathbb{E}[Y(2) | T = 2] \ne \mathbb{E}[Y(2)]\)</span>. To remedy this, we adjust for a covariate set (in this example, disease severity but in the primary analysis we adjust for revision type preference and additional patient characteristics) with the goal of achieving conditional exchangeability.</p>
</section>
<section id="section-3.1.1---surgical-domain" class="level1">
<h1>Section 3.1.1 - Surgical domain</h1>
<p>Question - Would it be more sensible to compute <span class="math inline">\(\mathbb{E}[Y|\dots]\)</span> from the inverse link transformed linear predictor and then compute the log-odds ratios from there or is the above acceptable??</p>
</section>
<section id="section-4.1---decision-procedures-overview" class="level1">
<h1>Section 4.1 - Decision procedures overview</h1>
<p>Define what happens to subsequent participants within a domain for which the decision has been dealt with. Presumably, the simplest approach is to simply add them into a non-randomised comparison for the domain for which the decision was made, but to introduce them into other domains based on the design dependencies.</p>
<p>Unsure whether it is sensible to be examining all subgroups in order to determine the outcome of futility, especially given the number of subgroups defined.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>